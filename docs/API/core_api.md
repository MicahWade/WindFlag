# Core API Endpoints

This section details the core endpoints of the WindFlag CTF Platform API. These endpoints provide general status checks and user-specific information.

## Authentication

All endpoints within the Core API namespace are protected and require proper authentication using a user-generated API key. This key serves as the credential to verify the identity and permissions of the requesting client.

*   **Mechanism**: The API key must be securely transmitted in the `X-API-KEY` HTTP header for every request made to these endpoints.
*   **Key Generation**: API keys can be generated by authenticated users directly from their profile page within the WindFlag web application. Administrators may have additional methods for generating API keys with broader scopes.
*   **Further Details**: For an in-depth understanding of API key generation, management, and security best practices, please refer to the dedicated [API Overview](./api_overview.md) documentation.

## 1. GET /status

This endpoint is designed to provide a quick health check of the API service and simultaneously validate the authenticity and activity of the provided API key.

*   **Description**: A simple yet vital endpoint to confirm that the API service is up and running. It also performs a basic check on the `X-API-KEY` header to ensure the API key is valid and belongs to an active user account. This is often the first API call made by integrated applications to verify connectivity and credentials.
*   **Method**: `GET`
*   **URL**: `/api/v1/status`
*   **Authentication**: `X-API-KEY` header (required). A valid API key associated with an active user is necessary.
*   **Example Request**:
    ```http
    GET /api/v1/status HTTP/1.1
    Host: your-ctf-platform.com
    X-API-KEY: YOUR_USER_API_KEY_HERE
    ```
*   **Example Response (Success - 200 OK)**:
    ```json
    {
        "message": "API key authenticated successfully!",
        "user": "authenticated_username",
        "api_status": "operational",
        "timestamp": "2025-11-24T10:30:00Z"
    }
    ```
    *   `message`: A confirmation message indicating successful authentication.
    *   `user`: The username of the user whose API key was used for authentication.
    *   `api_status`: Indicates the general operational status of the API (e.g., "operational", "maintenance").
    *   `timestamp`: The server-side UTC timestamp when the request was processed, useful for debugging and synchronization.
*   **Example Response (Error - 401 Unauthorized - Missing Key)**:
    ```json
    {
        "message": "API Key is missing from X-API-KEY header. Please provide a valid key.",
        "code": "AUTH_MISSING_API_KEY"
    }
    ```
*   **Example Response (Error - 401 Unauthorized - Invalid Key)**:
    ```json
    {
        "message": "Invalid or inactive API Key provided. Please check your credentials.",
        "code": "AUTH_INVALID_API_KEY"
    }
    ```
*   **Example Response (Error - 403 Forbidden - Inactive User)**:
    ```json
    {
        "message": "User associated with this API Key is inactive or suspended.",
        "code": "USER_INACTIVE"
    }
    ```

## 2. GET /users/me

This endpoint allows an authenticated client to retrieve the detailed profile information for the user associated with the API key currently in use. It's a self-service endpoint, providing data relevant only to the authenticated user.

*   **Description**: Returns a comprehensive set of profile details for the user whose API key is used to authenticate the request. This includes identification details, current performance metrics, and administrative roles. It's ideal for displaying user-specific information within external applications or integrations.
*   **Method**: `GET`
*   **URL**: `/api/v1/users/me`
*   **Authentication**: `X-API-KEY` header (required). A valid API key linked to an active user account is necessary.
*   **Example Request**:
    ```http
    GET /api/v1/users/me HTTP/1.1
    Host: your-ctf-platform.com
    X-API-KEY: YOUR_USER_API_KEY_HERE
    ```
*   **Example Response (Success - 200 OK)**:
    ```json
    {
        "id": 1,
        "username": "authenticated_username",
        "email": "user@example.com",
        "score": 1200,
        "is_admin": false,
        "is_super_admin": false,
        "hidden": false,
        "last_seen": "2023-10-26T14:30:00.000Z",
        "member_since": "2023-09-01T08:00:00Z",
        "profile_url": "https://your-ctf-platform.com/profile/authenticated_username"
    }
    ```
    *   `id` (integer): The unique numerical identifier for the user.
    *   `username` (string): The display name of the user.
    *   `email` (string): The registered email address of the user.
    *   `score` (integer): The current total score accumulated by the user from solved challenges and awards.
    *   `is_admin` (boolean): `true` if the user has administrative privileges, `false` otherwise.
    *   `is_super_admin` (boolean): `true` if the user has super-administrative privileges (highest level of access), `false` otherwise.
    *   `hidden` (boolean): `true` if the user is hidden from the public scoreboard, `false` otherwise.
    *   `last_seen` (string, ISO 8601): The UTC timestamp of the user's last activity on the platform.
    *   `member_since` (string, ISO 8601): The UTC timestamp when the user account was created.
    *   `profile_url` (string): A direct URL to the user's public profile page on the CTF platform.
*   **Example Response (Error - 401 Unauthorized)**:
    ```json
    {
        "message": "Invalid or inactive API Key. Authentication required.",
        "code": "AUTH_REQUIRED"
    }
    ```
*   **Example Response (Error - 500 Internal Server Error)**:
    ```json
    {
        "message": "An unexpected error occurred while retrieving user profile.",
        "code": "SERVER_ERROR",
        "details": "Please contact support with the timestamp of this error."
    }
    ```
